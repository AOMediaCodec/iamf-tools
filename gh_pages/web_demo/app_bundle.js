'use strict';var n;function aa(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var v=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,f){if(a==Array.prototype||a==Object.prototype)return a;a[b]=f.value;return a};
function ba(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var f=a[b];if(f&&f.Math==Math)return f}throw Error("Cannot find global object");}var w=ba(this);function x(a,b){if(b)a:{var f=w;a=a.split(".");for(var g=0;g<a.length-1;g++){var k=a[g];if(!(k in f))break a;f=f[k]}a=a[a.length-1];g=f[a];b=b(g);b!=g&&b!=null&&v(f,a,{configurable:!0,writable:!0,value:b})}}
x("Symbol",function(a){function b(m){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new f(g+(m||"")+"_"+k++,m)}function f(m,e){this.g=m;v(this,"description",{configurable:!0,writable:!0,value:e})}if(a)return a;f.prototype.toString=function(){return this.g};var g="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",k=0;return b});
x("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),f=0;f<b.length;f++){var g=w[b[f]];typeof g==="function"&&typeof g.prototype[a]!="function"&&v(g.prototype,a,{configurable:!0,writable:!0,value:function(){return ca(aa(this))}})}return a});function ca(a){a={next:a};a[Symbol.iterator]=function(){return this};return a}
function da(a){return ea(a,a)}function ea(a,b){a.raw=b;Object.freeze&&(Object.freeze(a),Object.freeze(b));return a}function y(a){var b=typeof Symbol!="undefined"&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if(typeof a.length=="number")return{next:aa(a)};throw Error(String(a)+" is not an iterable or ArrayLike");}function fa(a){for(var b,f=[];!(b=a.next()).done;)f.push(b.value);return f}function z(){this.l=!1;this.h=null;this.i=void 0;this.g=1;this.u=0;this.j=null}
function A(a){if(a.l)throw new TypeError("Generator is already running");a.l=!0}z.prototype.o=function(a){this.i=a};function B(a,b){a.j={fa:b,ha:!0};a.g=a.u}z.prototype.return=function(a){this.j={return:a};this.g=this.u};function C(a,b,f){a.g=f;return{value:b}}function ha(a){this.g=new z;this.h=a}function ia(a,b){A(a.g);var f=a.g.h;if(f)return D(a,"return"in f?f["return"]:function(g){return{value:g,done:!0}},b,a.g.return);a.g.return(b);return I(a)}
function D(a,b,f,g){try{var k=b.call(a.g.h,f);if(!(k instanceof Object))throw new TypeError("Iterator result "+k+" is not an object");if(!k.done)return a.g.l=!1,k;var m=k.value}catch(e){return a.g.h=null,B(a.g,e),I(a)}a.g.h=null;g.call(a.g,m);return I(a)}function I(a){for(;a.g.g;)try{var b=a.h(a.g);if(b)return a.g.l=!1,{value:b.value,done:!1}}catch(f){a.g.i=void 0,B(a.g,f)}a.g.l=!1;if(a.g.j){b=a.g.j;a.g.j=null;if(b.ha)throw b.fa;return{value:b.return,done:!0}}return{value:void 0,done:!0}}
function ja(a){this.next=function(b){A(a.g);a.g.h?b=D(a,a.g.h.next,b,a.g.o):(a.g.o(b),b=I(a));return b};this.throw=function(b){A(a.g);a.g.h?b=D(a,a.g.h["throw"],b,a.g.o):(B(a.g,b),b=I(a));return b};this.return=function(b){return ia(a,b)};this[Symbol.iterator]=function(){return this}}function ka(a){function b(g){return a.next(g)}function f(g){return a.throw(g)}return new Promise(function(g,k){function m(e){e.done?g(e.value):Promise.resolve(e.value).then(b,f).then(m,k)}m(a.next())})}
function J(a){return ka(new ja(new ha(a)))}function la(){for(var a=Number(this),b=[],f=a;f<arguments.length;f++)b[f-a]=arguments[f];return b}
x("Promise",function(a){function b(e){this.h=0;this.i=void 0;this.g=[];this.u=!1;var d=this.j();try{e(d.resolve,d.reject)}catch(c){d.reject(c)}}function f(){this.g=null}function g(e){return e instanceof b?e:new b(function(d){d(e)})}if(a)return a;f.prototype.h=function(e){if(this.g==null){this.g=[];var d=this;this.i(function(){d.l()})}this.g.push(e)};var k=w.setTimeout;f.prototype.i=function(e){k(e,0)};f.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var d=0;d<e.length;++d){var c=
e[d];e[d]=null;try{c()}catch(h){this.j(h)}}}this.g=null};f.prototype.j=function(e){this.i(function(){throw e;})};b.prototype.j=function(){function e(h){return function(l){c||(c=!0,h.call(d,l))}}var d=this,c=!1;return{resolve:e(this.M),reject:e(this.l)}};b.prototype.M=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof b)this.O(e);else{a:switch(typeof e){case "object":var d=e!=null;break a;case "function":d=!0;break a;default:d=!1}d?this.L(e):this.o(e)}};
b.prototype.L=function(e){var d=void 0;try{d=e.then}catch(c){this.l(c);return}typeof d=="function"?this.aa(d,e):this.o(e)};b.prototype.l=function(e){this.F(2,e)};b.prototype.o=function(e){this.F(1,e)};b.prototype.F=function(e,d){if(this.h!=0)throw Error("Cannot settle("+e+", "+d+"): Promise already settled in state"+this.h);this.h=e;this.i=d;this.h===2&&this.N();this.K()};b.prototype.N=function(){var e=this;k(function(){if(e.U()){var d=w.console;typeof d!=="undefined"&&d.error(e.i)}},1)};b.prototype.U=
function(){if(this.u)return!1;var e=w.CustomEvent,d=w.Event,c=w.dispatchEvent;if(typeof c==="undefined")return!0;typeof e==="function"?e=new e("unhandledrejection",{cancelable:!0}):typeof d==="function"?e=new d("unhandledrejection",{cancelable:!0}):(e=w.document.createEvent("CustomEvent"),e.initCustomEvent("unhandledrejection",!1,!0,e));e.promise=this;e.reason=this.i;return c(e)};b.prototype.K=function(){if(this.g!=null){for(var e=0;e<this.g.length;++e)m.h(this.g[e]);this.g=null}};var m=new f;b.prototype.O=
function(e){var d=this.j();e.P(d.resolve,d.reject)};b.prototype.aa=function(e,d){var c=this.j();try{e.call(d,c.resolve,c.reject)}catch(h){c.reject(h)}};b.prototype.then=function(e,d){function c(r,t){return typeof r=="function"?function(F){try{h(r(F))}catch(G){l(G)}}:t}var h,l,q=new b(function(r,t){h=r;l=t});this.P(c(e,h),c(d,l));return q};b.prototype.catch=function(e){return this.then(void 0,e)};b.prototype.P=function(e,d){function c(){switch(h.h){case 1:e(h.i);break;case 2:d(h.i);break;default:throw Error("Unexpected state: "+
h.h);}}var h=this;this.g==null?m.h(c):this.g.push(c);this.u=!0};b.resolve=g;b.reject=function(e){return new b(function(d,c){c(e)})};b.race=function(e){return new b(function(d,c){for(var h=y(e),l=h.next();!l.done;l=h.next())g(l.value).P(d,c)})};b.all=function(e){var d=y(e),c=d.next();return c.done?g([]):new b(function(h,l){function q(F){return function(G){r[F]=G;t--;t==0&&h(r)}}var r=[],t=0;do r.push(void 0),t++,g(c.value).P(q(r.length-1),l),c=d.next();while(!c.done)})};return b});
function L(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var ma=typeof Object.assign=="function"?Object.assign:function(a,b){for(var f=1;f<arguments.length;f++){var g=arguments[f];if(g)for(var k in g)L(g,k)&&(a[k]=g[k])}return a};x("Object.assign",function(a){return a||ma});
x("WeakMap",function(a){function b(c){this.g=(d+=Math.random()+1).toString();if(c){c=y(c);for(var h;!(h=c.next()).done;)h=h.value,this.set(h[0],h[1])}}function f(){}function g(c){var h=typeof c;return h==="object"&&c!==null||h==="function"}function k(c){if(!L(c,e)){var h=new f;v(c,e,{value:h})}}function m(c){var h=Object[c];h&&(Object[c]=function(l){if(l instanceof f)return l;Object.isExtensible(l)&&k(l);return h(l)})}if(function(){if(!a||!Object.seal)return!1;try{var c=Object.seal({}),h=Object.seal({}),
l=new a([[c,2],[h,3]]);if(l.get(c)!=2||l.get(h)!=3)return!1;l.delete(c);l.set(h,4);return!l.has(c)&&l.get(h)==4}catch(q){return!1}}())return a;var e="$jscomp_hidden_"+Math.random();m("freeze");m("preventExtensions");m("seal");var d=0;b.prototype.set=function(c,h){if(!g(c))throw Error("Invalid WeakMap key");k(c);if(!L(c,e))throw Error("WeakMap key fail: "+c);c[e][this.g]=h;return this};b.prototype.get=function(c){return g(c)&&L(c,e)?c[e][this.g]:void 0};b.prototype.has=function(c){return g(c)&&L(c,
e)&&L(c[e],this.g)};b.prototype.delete=function(c){return g(c)&&L(c,e)&&L(c[e],this.g)?delete c[e][this.g]:!1};return b});
x("Map",function(a){function b(){var d={};return d.C=d.next=d.head=d}function f(d,c){var h=d[1];return ca(function(){if(h){for(;h.head!=d[1];)h=h.C;for(;h.next!=h.head;)return h=h.next,{done:!1,value:c(h)};h=null}return{done:!0,value:void 0}})}function g(d,c){var h=c&&typeof c;h=="object"||h=="function"?m.has(c)?h=m.get(c):(h=""+ ++e,m.set(c,h)):h="p_"+c;var l=d[0][h];if(l&&L(d[0],h))for(d=0;d<l.length;d++){var q=l[d];if(c!==c&&q.key!==q.key||c===q.key)return{id:h,list:l,index:d,m:q}}return{id:h,
list:l,index:-1,m:void 0}}function k(d){this[0]={};this[1]=b();this.size=0;if(d){d=y(d);for(var c;!(c=d.next()).done;)c=c.value,this.set(c[0],c[1])}}if(function(){if(!a||typeof a!="function"||!a.prototype.entries||typeof Object.seal!="function")return!1;try{var d=Object.seal({x:4}),c=new a(y([[d,"s"]]));if(c.get(d)!="s"||c.size!=1||c.get({x:4})||c.set({x:4},"t")!=c||c.size!=2)return!1;var h=c.entries(),l=h.next();if(l.done||l.value[0]!=d||l.value[1]!="s")return!1;l=h.next();return l.done||l.value[0].x!=
4||l.value[1]!="t"||!h.next().done?!1:!0}catch(q){return!1}}())return a;var m=new WeakMap;k.prototype.set=function(d,c){d=d===0?0:d;var h=g(this,d);h.list||(h.list=this[0][h.id]=[]);h.m?h.m.value=c:(h.m={next:this[1],C:this[1].C,head:this[1],key:d,value:c},h.list.push(h.m),this[1].C.next=h.m,this[1].C=h.m,this.size++);return this};k.prototype.delete=function(d){d=g(this,d);return d.m&&d.list?(d.list.splice(d.index,1),d.list.length||delete this[0][d.id],d.m.C.next=d.m.next,d.m.next.C=d.m.C,d.m.head=
null,this.size--,!0):!1};k.prototype.clear=function(){this[0]={};this[1]=this[1].C=b();this.size=0};k.prototype.has=function(d){return!!g(this,d).m};k.prototype.get=function(d){return(d=g(this,d).m)&&d.value};k.prototype.entries=function(){return f(this,function(d){return[d.key,d.value]})};k.prototype.keys=function(){return f(this,function(d){return d.key})};k.prototype.values=function(){return f(this,function(d){return d.value})};k.prototype.forEach=function(d,c){for(var h=this.entries(),l;!(l=h.next()).done;)l=
l.value,d.call(c,l[1],l[0],this)};k.prototype[Symbol.iterator]=k.prototype.entries;var e=0;return k});x("Promise.prototype.finally",function(a){return a?a:function(b){return this.then(function(f){return Promise.resolve(b()).then(function(){return f})},function(f){return Promise.resolve(b()).then(function(){throw f;})})}});x("globalThis",function(a){return a||w});var M=!1,N=!1,O;function na(a,b,f){a.addEventListener("change",function(){b.controls=a.checked;f.controls=a.checked})}
function oa(a){O=a;N=M=!1;O.B.addEventListener("click",pa);O.I.addEventListener("click",function(){N=!1;P();Q();O.timeline.redraw()});O.G.addEventListener("click",function(){N=!0;P();Q();O.timeline.redraw()});O.s.addEventListener("ended",qa);O.v.addEventListener("ended",qa);O.timeline.setIsBinauralGetter(function(){return N});O.timeline.setTimeControlGetter(ra);O.timeline.setTimeControlSetter(sa);O.B.textContent="\u23f5";P();Q()}
function pa(){M?ta():(M=!0,O.s.play(),O.v.play(),O.timeline.play(),O.video.hidden||O.video.play(),O.B.textContent="\u23f8")}function ra(){return O.s.currentTime/O.s.duration}function sa(a){a*=O.s.duration;O.s.currentTime=a;O.v.currentTime=a;O.video.currentTime=a}function ta(){M=!1;O.s.pause();O.v.pause();O.timeline.pause();O.video.hidden||O.video.pause();O.B.textContent="\u23f5"}function P(){O.s.muted=N;O.v.muted=!N}
function Q(){N?(O.I.classList.remove("activeButton"),O.G.classList.add("activeButton")):(O.I.classList.add("activeButton"),O.G.classList.remove("activeButton"))}function qa(){M=!1;O.timeline.pause();O.B.textContent="\u23f5"};function ya(a,b){var f=za(b);if(f%2!==0)throw Error("Number of samples, "+f+" is not a multiple of 2");return Aa(a,f/2,Ba.bind(null,b))}
function Aa(a,b,f){function g(h,l){d.setUint32(h,l,!0);return h+4}function k(h,l){d.setUint16(h,l,!0);return h+2}function m(h,l){for(var q=0;q<l.length;++q)d.setUint8(h+q,l.charCodeAt(q));return h+l.length}if(a<1||b<1)throw Error("Invalid arguments to createInt16WavFile");var e=b*4;b=new ArrayBuffer(44+e);var d=new DataView(b);var c=m(0,"RIFF");c=g(c,36+e);c=m(c,"WAVE");c=m(c,"fmt ");c=g(c,16);c=k(c,1);c=k(c,2);c=g(c,a);c=g(c,a*4);c=k(c,4);c=k(c,16);c=m(c,"data");c=g(c,e);if(c!==44)throw Error("We should have written exactly 44 bytes at this point.");
a=new DataView(b,c);f(a);return b}function za(a){return a.reduce(function(b,f){return b+f.length},0)}function Ba(a,b){if(za(a)*2!==b.byteLength)throw Error("Input int16 length "+a.length+" does not match destination byte length "+b.byteLength);var f=0;a=y(a);for(var g=a.next();!g.done;g=a.next()){g=g.value;for(var k=0;k<g.length;++k)b.setInt16(f+2*k,g[k],!0);f+=2*g.length}};function Ca(a){var b=b===void 0?{V:150}:b;if(b.V<1)throw Error("Number of buckets must be at least 1.");a=new DataView(a,44);if(a.byteLength%2)throw Error("Amount of data does not divide evenly into int16s.");for(var f=Math.floor(a.byteLength/2/b.V),g=[],k=0,m=0,e=0;e<a.byteLength;e+=2){var d=a.getInt16(e,!0);m+=d*d;++k;if(k>=f&&(g.push(Math.sqrt(m/k)),k=m=0,g.length===b.V))break}var c=Math.max.apply(Math,[1E-6].concat(g instanceof Array?g:fa(y(g))));return g.map(function(h){return h/c})};function Da(a){a=y(a);for(var b=a.next();!b.done;b=a.next())b.value.disabled=!1};var Ea=new Map([["Animated demo (3rd-order ambisonics)","./data/Animated_demo_3OA.iamf"],["Animated demo (3rd-order ambisonics + stereo)","./data/Animated_demo_3OA_and_2_0.iamf"]]);
function Fa(a){var b,f,g,k,m,e,d;return J(function(c){if(c.g==1){b=Ea.get(a);if(!b)return c.return(Promise.reject(Error("Demo file does not exist.")));console.log("Attempting to fetch IAMF file: "+b);f="application/octet-stream";g=performance.now();return C(c,fetch(b,{headers:{Accept:f}}),2)}if(c.g!=3){k=c.i;m=((performance.now()-g)/1E3).toFixed(3);if(!k.ok)return c.return(Promise.reject(Error("Could not load specified IAMF file: "+k.statusText)));e=k.headers.get("content-type");e!==f&&console.warn("Received content-type: "+
e+" rather than "+f);return C(c,k.arrayBuffer(),3)}d=c.i;console.log("Fetched "+d.byteLength+" bytes from "+b+" in "+m+" seconds.");return c.return(d)})};function Ga(a){var b=console.log;console.log=function(k){b(k);R(a,k)};console.debug=console.info=console.log;var f=console.warn;console.warn=function(k){f(k);R(a,"WARNING: "+k)};var g=console.error;console.error=function(k){g(k);R(a,"ERROR: "+k)}}function R(a,b){var f=document.createElement("pre");f.textContent="["+(new Date).toLocaleTimeString()+"] "+b;a.appendChild(f);a.scrollTop=a.scrollHeight};function Ha(){var a=document.getElementById("logBox");if(!a)throw Error("No log box could be found.");var b=document.getElementById("demoFile");if(!b)throw Error("Demo file element not found");var f=document.getElementById("outputSampleRate");if(!f)throw Error("Output sample rate element not found");var g=document.getElementById("advancedSettingsCheckbox");if(!g)throw Error("No advanced settings checkbox could be found.");var k=document.getElementById("advancedSettings");if(!k)throw Error("No advanced settings div could be found.");
var m=document.getElementById("showAudioElementsCheckbox");if(!m)throw Error("No show audio elements checkbox could be found.");var e=document.getElementById("fileDrop");if(!e)throw Error("No file drop div could be found.");var d=document.getElementById("playPauseButton");if(!d)throw Error("No play/pause button could be found.");var c=document.getElementById("stereoButton");if(!c)throw Error("No stereo button could be found.");var h=document.getElementById("stereoPlayback");if(!h)throw Error("No stereo audio element found.");
var l=document.getElementById("binauralButton");if(!l)throw Error("No binaural button could be found.");var q=document.getElementById("binauralPlayback");if(!q)throw Error("No binaural audio element found.");var r=document.getElementById("videoPlayback");if(!r)throw Error("No video element found.");var t=document.getElementById("timelineCanvas");if(!t)throw Error("No timeline element found.");return{ia:a,D:b,S:f,ca:g,ba:k,pa:m,R:e,B:d,I:c,s:h,G:l,v:q,Z:r,ra:t}};var S=void 0,T=void 0;function Ia(a,b){S=a;T=b}function Ja(a,b,f,g,k,m,e){var d;J(function(c){d=!1;if(!S||S.byteLength===0)return e(d),c.return();T||(console.error("No filename set for current IAMF bytes, setting to iamf_audio."),T="iamf_audio");return C(c,Promise.all([Ka(b,a,g),Ka(f,a,k)]).then(function(h){var l=y(h);h=l.next().value;d=l.next().value||h}).catch(function(h){console.error("Error during decoding: ",h.message);m()}).finally(function(){e(d)}),0)})};/*

 Copyright Google LLC
 SPDX-License-Identifier: Apache-2.0
*/
var La=globalThis.trustedTypes,U;function Ma(){var a=null;if(!La)return a;try{var b=function(f){return f};a=La.createPolicy("goog#html",{createHTML:b,createScript:b,createScriptURL:b})}catch(f){}return a};function V(a){this.g=a}V.prototype.toString=function(){return this.g+""};function Na(a){U===void 0&&(U=Ma());var b=U;return new V(b?b.createScriptURL(a):a)};function W(a){this.g=a}W.prototype.toString=function(){return this.g};function Oa(a){if(a instanceof W)return a.g;throw Error("");};function Pa(a){if(typeof MediaSource!=="undefined"&&a instanceof MediaSource)return new W(URL.createObjectURL(a));var b=a.type.match(/^([^;]+)(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i);if((b==null?void 0:b.length)!==2||!(/^image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon|heic|heif|avif|x-ms-bmp)$/i.test(b[1])||/^video\/(?:mpeg|mp4|ogg|webm|x-matroska|quicktime|x-ms-wmv)$/i.test(b[1])||/^audio\/(?:3gpp2|3gpp|aac|amr|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)$/i.test(b[1])||/^font\/\w+/i.test(b[1])))throw Error("");
return new W(URL.createObjectURL(a))};function Qa(a){var b=la.apply(1,arguments);if(b.length===0)return Na(a[0]);for(var f=a[0],g=0;g<b.length;g++)f+=encodeURIComponent(b[g])+a[g+1];return Na(f)};function Ra(a,b,f){a.src=Oa(Pa(new Blob([b],{type:"audio/wav"})));a.title=f};var Sa={Y:"#ccc",qa:"#ccc",da:"#8c9dd8",spacing:2,A:16,J:10,sa:4,na:2,ma:"#ffc80c",oa:"#12b17d55"};
function Ta(a){var b=b===void 0?{}:b;this.g=a;this.K=void 0;this.j=this.l=!0;this.o=!1;this.F=0;this.U=function(){return!1};this.N=function(){return-1};this.O=function(){};this.i=this.u=null;this.config=Object.assign({},Sa,b);this.h=this.g.getContext("2d",{willReadFrequently:!0});this.g.addEventListener("mousedown",this.ja.bind(this));this.g.addEventListener("mousemove",this.ka.bind(this));this.g.addEventListener("mouseup",this.la.bind(this));this.M=new ImageData(this.g.width,this.g.height);this.L=
new ImageData(this.g.width,this.g.height)}n=Ta.prototype;n.setIsBinauralGetter=function(a){this.U=a};n.setTimeControlGetter=function(a){this.N=a};n.setTimeControlSetter=function(a){this.O=a};n.redraw=function(){this.l||this.j||this.o||X(this)};n.play=function(){this.o=!0;this.F=requestAnimationFrame(this.W.bind(this))};n.pause=function(){this.o=!1;cancelAnimationFrame(this.F);X(this)};
function Y(a){a.K?a.h.putImageData(a.K,0,0):(a.h.clearRect(0,0,a.g.width,a.g.height),a.h.fillStyle=a.config.Y,a.h.font="24px Google Sans",a.h.fillText("Decoding...",10,30),a.K=a.h.getImageData(0,0,a.g.width,a.g.height))}
function Ua(a,b){a.h.clearRect(0,0,a.g.width,a.g.height);for(var f=(a.g.width-2*a.config.A-(b.length-1)*a.config.spacing)/b.length,g=a.config.A,k=f+a.config.spacing,m=a.g.height-2*a.config.J,e=a.g.height/2,d=0;d<b.length;d++){var c=Math.max(b[d]*m,a.config.sa);a.h.fillRect(g+d*k,e-c/2,f,c)}}n.ja=function(a){this.l||this.j||(this.u=a)};n.ka=function(a){!this.u||this.l||this.j||(Va(this,a),this.o||X(this))};
n.la=function(a){this.l||this.j||(Va(this,a),this.u=null,this.i?Wa(this,this.i.T):Wa(this,a.offsetX),this.o||X(this))};function Va(a,b){if(a.u){var f=a.config.A,g=a.g.width-a.config.A,k=Math.max(Math.min(a.u.offsetX,g),f);b=Math.max(Math.min(b.offsetX,g),f);Math.abs(k-b)>10?a.i={T:Math.min(k,b),X:Math.max(k,b)}:a.i=null}}function Wa(a,b){a.O(Math.max(0,Math.min(1,(b-a.config.A)/(a.g.width-2*a.config.A))))}n.W=function(){this.o&&(this.i&&Xa(this)>this.i.X&&Wa(this,this.i.T),X(this),this.F=requestAnimationFrame(this.W.bind(this)))};
function X(a){a.h.clearRect(0,0,a.g.width,a.g.height);a.U()?a.h.putImageData(a.L,0,0):a.h.putImageData(a.M,0,0);a.i&&(a.h.fillStyle=a.config.oa,a.h.fillRect(a.i.T,a.config.J,a.i.X-a.i.T,a.g.height-2*a.config.J));var b=Xa(a);a.h.fillStyle=a.config.ma;a.h.fillRect(b,a.config.J,a.config.na,a.g.height-2*a.config.J)}function Xa(a){var b=a.N();return!b||b<0?a.config.A:a.config.A+b*(a.g.width-2*a.config.A)};function Ya(a,b){a.checked=!1;a.addEventListener("change",function(){b.hidden=!a.checked})}function Za(a,b){return{ta:a.value,H:Number(b.value)}};var $a=new Map([["Animated demo (3rd-order ambisonics)","./data/videos/Animated_demo_720_silent.mp4"],["Animated demo (3rd-order ambisonics + stereo)","./data/videos/Animated_demo_720_silent.mp4"]]);
function ab(a,b){var f,g,k,m;J(function(e){if(e.g==1){f=$a.get(a);if(!f)return b.src="",b.hidden=!0,e.return();console.log("Video file: "+f);return C(e,fetch(f),2)}if(e.g!=3)return g=e.i,g.ok?C(e,g.arrayBuffer(),3):(b.src="",b.hidden=!0,console.warn("Failed to load video file: "+f),e.return());k=e.i;m=new Blob([k],{type:"video/mp4"});b.src=Oa(Pa(m));b.hidden=!1;e.g=0})};function bb(a){var b=Worker;if(a instanceof V)a=a.g;else throw Error("");return new b(a,void 0)};var cb=da(["./decoder_worker_bundle.js"]);function Z(a,b){var f=this;this.binaural=a;this.j=b;this.g=a?"Binaural":"Stereo";a=Qa(cb);this.i=bb(a);this.i.addEventListener("message",this.o.bind(this));this.i.addEventListener("error",function(g){console.log("Error from "+f.g+" worker: "+g.message)});this.i.addEventListener("messageerror",function(g){console.log("Message error from "+f.g+" worker: "+g)});this.i.postMessage({eventType:"CREATE_DECODER"})}
function Ka(a,b,f){var g=S,k=T;return J(function(m){if(m.g==1){if(a.j)throw Error("Worker is not ready, wait for workerReadyCallback.");console.log("Starting "+a.g+" decoding.");return C(m,new Promise(a.l.bind(a,g,k,b,f)),2)}return m.return(m.i)})}
Z.prototype.o=function(a){switch(a.data.eventType){case "LOG_MESSAGE":console.log(this.g+" decoder: "+a.data.message);break;case "DECODER_CREATED":this.j?(console.log(this.g+" decoder created."),this.j(),this.j=void 0):console.warn(this.g+" decoder reporting ready more than once.");break;case "DECODE_DONE":db(this,a.data.outputBuffers);break;case "ERROR":a=a.data.message;console.error("Error from "+this.g+" decoder: "+a+".Aborting decoding.");this.h&&(this.h.reject(a),this.h=void 0);break;default:console.warn("Worker sent unhandled message: "+
JSON.stringify(a,["type","data","message"])+".")}};Z.prototype.l=function(a,b,f,g,k,m){this.h={start:performance.now(),ga:b,H:f,ea:g,resolve:k,reject:m};this.i.postMessage({eventType:"DECODE",eventData:{iamfBytes:a,sampleRate:f,binaural:this.binaural}})};
function db(a,b){if(a.h){var f=a.h,g=!1;console.log(a.g+" decoding done in "+((performance.now()-f.start)/1E3).toFixed(3)+" seconds.");if(b&&b.length>0){g=!0;var k=(b.reduce(function(m,e){return m+e.length},0)/f.H/2).toFixed(3);console.log(a.g+" render result is "+k+" seconds.");k=f.ga+"_"+(a.binaural?"binaural":"loudspeakers_A")+"_"+f.H+"Hz.wav";b=ya(f.H,b);f.ea(b,k)}a.h.resolve(g);a.h=void 0}else console.log("{this.layoutString} decoder reporting done without decodingRunState present.")};(function(){var a,b,f,g,k,m,e,d,c,h,l,q,r,t,F,G,ua;return J(function(eb){a=Ha();Ga(a.ia);Ya(a.ca,a.ba);na(a.pa,a.s,a.v);b=new Ta(a.ra);oa({B:a.B,I:a.I,G:a.G,s:a.s,v:a.v,video:a.Z,timeline:b});f=function(){a.R.classList.add("div-disabled");for(var p=y([a.D,a.S,a.B]),u=p.next();!u.done;u=p.next())u.value.disabled=!0};g=function(){O&&ta();b.l=!0;b.j=!0;Y(b);f()};k=function(p){Da([a.D,a.S]);a.R.classList.remove("div-disabled");p&&Da([a.B])};m=0;e=function(){m++;console.log(m+" worker"+(m===1?"":"s")+
" ready.");m===2&&k(!1)};d=new Z(!1,e);c=new Z(!0,e);h=Za.bind(null,a.D,a.S);l=function(p,u){Ra(a.s,p,u);p=Ca(p);b.l=!1;b.i=null;b.h.fillStyle=b.config.qa;Ua(b,p);b.M=b.h.getImageData(0,0,b.g.width,b.g.height);b.l||b.j?Y(b):X(b)};q=function(p,u){Ra(a.v,p,u);p=Ca(p);b.j=!1;b.i=null;b.h.fillStyle=b.config.da;Ua(b,p);b.L=b.h.getImageData(0,0,b.g.width,b.g.height);b.l||b.j?Y(b):X(b)};r=function(){b.h.clearRect(0,0,b.g.width,b.g.height);b.h.fillStyle=b.config.Y;b.h.font="24px Google Sans";b.h.fillText("Error",
10,30)};t=function(){ab(a.D.value,a.Z);Ja(h().H,d,c,l,q,r,k)};F=function(){var p;return J(function(u){p=a.D.value;g();return C(u,Fa(p).then(function(H){return J(function(E){Ia(H,p);t();E.g=0})}).catch(function(H){console.error(H.message)}),0)})};a.D.addEventListener("change",function(){return J(function(p){return C(p,F(),0)})});G=function(){return J(function(p){g();t();p.g=0})};a.S.addEventListener("change",function(){return J(function(p){return C(p,G(),0)})});ua=function(p){var u,H;return J(function(E){if(E.g==
1){p.preventDefault();g();var K;var va;if((K=p.dataTransfer)==null?0:(va=K.files)==null?0:va.length){var wa,xa;console.log("Received "+((wa=p.dataTransfer)==null?void 0:(xa=wa.files)==null?void 0:xa.length)+" files.");console.log("Using the first file: "+p.dataTransfer.files[0].name);K={filename:p.dataTransfer.files[0].name,data:p.dataTransfer.files[0].arrayBuffer()}}else console.error("No files found in drop."),K=void 0;u=K;if(!u){E.g=0;return}H=Ia;return C(E,u.data,3)}H(E.i,u.filename);a.D.value=
"";t();E.g=0})};a.R.addEventListener("dragover",function(p){p.preventDefault()});a.R.addEventListener("drop",ua);eb.g=0})})();
